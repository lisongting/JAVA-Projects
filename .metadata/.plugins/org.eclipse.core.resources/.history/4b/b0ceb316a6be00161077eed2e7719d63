package APPServerTest;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.text.SimpleDateFormat;
import java.util.Date;

public class SimpleServer {
	
	public void startServer()throws Exception{
		InetAddress inetAddress =InetAddress.getLocalHost();
		ServerSocket ss = new ServerSocket(30000);
		System.out.println("getHostAddress"+inetAddress.getHostAddress());
		while (true){
			Socket s  = ss.accept();
//			OutputStream os = s.getOutputStream();
//			os.write("收到来自服务器的问候<国庆快乐>".getBytes("utf-8"));
//			os.close();
			System.out.println("已连接一个客户端");
			getTime();
			InputStream inputStream =  s.getInputStream();
			InputStreamReader inputSReader = new InputStreamReader(inputStream,"utf-8");
			BufferedReader reader = new BufferedReader(inputSReader);
			String ip = s.getInetAddress().toString();
			String tmp ;
			System.out.println("客户端ip地址是："+ip);
			//if(reader.r)
			while((tmp=reader.readLine())!=null){
				System.out.println("app发来的消息："+tmp);
				getTime();
			}
			s.close();
		}
	}
	public static void main(String[] args){
		SimpleServer server = new SimpleServer();
		try{
			server.startServer();
		}catch(Exception e){
			e.printStackTrace();
		}
	}
	public void getTime(){
		Date date = new Date();
		SimpleDateFormat sdf  = new SimpleDateFormat("yyyy--MM--dd--HH--mm--ss");
		//String str = sdf.format(System.currentTimeMillis());
		String str = sdf.format(date);
		System.out.println("时间是："+str);
		
	}
}
