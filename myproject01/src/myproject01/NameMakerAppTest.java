package myproject01;

import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
/**
 * 输入5个数的array数组,与600个随机进行匹配
 * @author Administrator
 *
 */
public class NameMakerAppTest {
	static final int DATA_ROW=600;
	
	public static void main(String[] args) {
		new NameMakerAppTest().run();
		
	}
	
	public void run(){
		int[] int_keys = new int[DATA_ROW];
		int [][] int_keys2 = new int[DATA_ROW][5];
		String [] str = new String[DATA_ROW];
		int[] array = new int[5];
		List<Integer> resultList = new ArrayList<>();
		try {
			FileReader freader = new FileReader("data.txt");
			BufferedReader buffer = new BufferedReader(freader);
			String tmp = null;
			int h=0;
			while((tmp=buffer.readLine())!=null){
				int_keys[h] = Integer.parseInt(tmp);
				h++;
			}
		} catch (FileNotFoundException e) {
			e.printStackTrace();
		}catch(Exception e){
			e.printStackTrace();
		}
		
		for(int i=0;i<DATA_ROW;i++){
			 str[i] =  String.valueOf(int_keys[i]);
			for(int j=0;j<5;j++){
				int_keys2[i][j] = str[i].charAt(j)-48;
			}
		}
		
		System.out.println("输入array数组");
		Scanner input = new Scanner(System.in);
		for(int i=0;i<5;i++){
			array[i] = input.nextInt();
		}
		resultList = find(array,int_keys,int_keys2);
		for(int tt:resultList){
			System.out.println("匹配到的是:"+tt);
		}
		
	}
	
	public List<Integer> find(int array[],int int_keys[],int int_keys2[][]){
		int count = 5;//5个有效位
		List<Integer> result = new ArrayList<>();
		for(int i=0;i<5;i++){
			if(array[i]==0){
				count--;
			}
		}
		if(count==5){
			//先把array数组转化为5位的整数形式
			StringBuilder tmp=new StringBuilder();
			for(int i=0;i<5;i++){
				tmp.append(array[i]);
			}
			int value = Integer.parseInt(tmp.toString());
			//直接匹配
			for(int i=0;i<DATA_ROW;i++){
				if(value==int_keys[i]){
					result.add(int_keys[i]);
				}
			}
			//直接匹配失败,则变成4位去找
			if(result.isEmpty()){
				//将array的每一位都依次变成0,循环5次,按照4位的条件去找
				for(int i=0;i<5;i++){
					int t = array[i];
					array[i]=0;
					//按照4位的形式进行对比
					int[] index = new int[4];
					for(int j=0,k=0;j<5&&k<4;j++){
						if(array[j]!=0){
							index[k]=j;
							k++;
						}
					}
					for(int j=0;j<DATA_ROW;j++){
						if(int_keys2[j][index[0]]==array[index[0]]
								&&int_keys2[j][index[1]]==array[index[1]]
								&&int_keys2[j][index[2]]==array[index[2]]
								&&int_keys2[j][index[3]]==array[index[3]]){
							result.add(int_keys[j]);//如果直接匹配到,则加入到结果集合中
						}
					}
					array[i]=t;
				}
				//如果按照4位的条件去找依然失败,则变成3位,按照3位的条件去匹配
				if(result.isEmpty()){
					//5位的数,取两位为0,这种情况会生成10个值
					for(int i=0;i<4;i++){
						int t1 = array[i];
						array[i]=0;
						for(int j=i+1;j<5;j++){
							int t2 = array[j];
							array[j]=0;
							result = findByThree(array,int_keys,int_keys2,result);
							array[j] = t2;
						}
						array[i] = t1;
					}
				}
			}
		}else if(count==4){
			result = findByFour(array,int_keys,int_keys2,result);
		}else if(count==3){
			result = findByThree(array,int_keys,int_keys2,result);
		}else{
			System.out.println("输入条件异常");
		}
		return result;
	}
	
	
	public List<Integer> findByFour(int array[],int int_keys[],int int_keys2[][],List<Integer> result){
		int[] index = new int[4];//用来标记四位数字在数组中的下标
		for(int i=0,j=0;i<5&&j<4;i++){
			if(array[i]!=0){
				index[j]=i;
				j++;
			}
		}
		int id0 = index[0];int id1 = index[1];int id2 = index[2];int id3 = index[3];//各有效位的下标
		int a = array[id0];int b = array[id1];int c = array[id2];int d = array[id3];//各有效位的值
		//第一轮,直接匹配
		for(int i=0;i<DATA_ROW;i++){
			if(int_keys2[i][id0]==a
					&&int_keys2[i][id1]==b
					&&int_keys2[i][id2]==c
					&&int_keys2[i][id3]==d){
				result.add(int_keys[i]);//如果直接匹配到,则加入到结果集合中
			}
		}
		//如果第一轮没有匹配到,则将4位有效位依次赋值0,转变为3位的值,进行3位匹配算法
		if(result.isEmpty()){
			for(int i=0;i<4;i++){
				int tmp = array[i];
				array[index[i]]=0;
				result = findByThree(array,int_keys,int_keys2,result);
				array[index[i]] = tmp;
			}
		}else{
			return result;
		}
		return result;
		
	}
	
	public List<Integer> findByThree(int array[],int int_keys[],int int_keys2[][],List<Integer> result){
		int[] index = new int[3];//用来标记三位数字在数组中的下标
		for(int i=0,j=0;i<5&&j<3;i++){
			if(array[i]!=0){
				index[j]=i;
				j++;
			}
		}
		int id0 = index[0];int id1 = index[1];int id2 = index[2];//各有效位的下标
		int a = array[id0];int b = array[id1];int c = array[id2];//各有效位的值
		if(a==0||b==0||c==0){
			System.out.println("条件异常");
			return result;
		}
		//第一轮:直接匹配,3个位置的数一一对应相等
		for(int i=0;i<DATA_ROW;i++){
			if(int_keys2[i][id0]==a&&int_keys2[i][id1]==b&&int_keys2[i][id2]==c){
				result.add(int_keys[i]);//如果直接匹配到,则加入到结果集合中
			}
		}
		//如果没有找到结果,则进行第二轮:任意两个位置一样的数对应相等
		if(result.isEmpty()){
			for(int i=0;i<DATA_ROW;i++){
				if(int_keys2[i][id0]==a&&int_keys2[i][id1]==b)
					result.add(int_keys[i]);
				if(int_keys2[i][id0]==a&&int_keys2[i][id2]==c)
					result.add(int_keys[i]);
				if(int_keys2[i][id1]==b&&int_keys2[i][id2]==c)
					result.add(int_keys[i]);
			}
			
		}
		
		return result;
	}
}
